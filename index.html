<!DOCTYPE html>
<html lang="pt-pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Elite Cognitiva v6.0</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>

/* SEU CSS ORIGINAL MANTIDO */

:root {
--bg:#0f172a;
--panel:#1e293b;
--accent:#3b82f6;
--text:#f8fafc;
--win:#10b981;
--lose:#ef4444;
}

body{
background:linear-gradient(135deg,var(--bg),#172554);
color:white;
font-family:Poppins;
text-align:center;
padding:20px;
}

#board{
display:grid;
gap:6px;
max-width:450px;
margin:auto;
}

.cell{
background:#cbd5e1;
color:black;
padding:15px;
cursor:pointer;
border-radius:8px;
}

.rank-item{
background:#1e293b;
margin:5px;
padding:10px;
border-radius:8px;
display:flex;
justify-content:space-between;
}

.tab{
cursor:pointer;
display:inline-block;
padding:8px;
background:#334155;
margin:2px;
border-radius:6px;
}

.tab.active{
background:#3b82f6;
}

</style>
</head>

<body>

<h1>‚ôû Elite Cognitiva</h1>

<input id="playerName" value="Jogador">

<select id="mode">
<option value="5">5√ó5</option>
<option value="6">6√ó6</option>
<option value="7">7√ó7</option>
<option value="8">8√ó8</option>
</select>

<button onclick="startGame()">Iniciar</button>

<div id="board"></div>

<h3>üèÜ Ranking Online</h3>

<div>

<span class="tab active" onclick="selectTab(5)" id="tab5">5√ó5</span>
<span class="tab" onclick="selectTab(6)" id="tab6">6√ó6</span>
<span class="tab" onclick="selectTab(7)" id="tab7">7√ó7</span>
<span class="tab" onclick="selectTab(8)" id="tab8">8√ó8</span>

</div>

<div id="ranking"></div>


<script type="module" src="firebase-config.js"></script>

<script>

let size=5;
let board=[];
let current=1;
let lastPos=null;
let active=false;

const moves=[[2,1],[1,2],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]];

const boardDiv=document.getElementById("board");
const rankingDiv=document.getElementById("ranking");
const playerName=document.getElementById("playerName");

let currentTab=5;


function startGame(){

size=parseInt(document.getElementById("mode").value);

createBoard();

current=1;
lastPos=null;
active=true;

}


function createBoard(){

board=[];
boardDiv.innerHTML="";

boardDiv.style.gridTemplateColumns=
`repeat(${size},1fr)`;

for(let r=0;r<size;r++){

board[r]=[];

for(let c=0;c<size;c++){

board[r][c]=0;

let cell=document.createElement("div");

cell.className="cell";

cell.onclick=()=>clickCell(r,c,cell);

boardDiv.appendChild(cell);

}

}

}


function validMove(r,c){

if(!lastPos)return true;

return moves.some(m=>
lastPos[0]+m[0]==r &&
lastPos[1]+m[1]==c
);

}


function clickCell(r,c,cell){

if(!active)return;

if(board[r][c])return;

if(validMove(r,c)){

board[r][c]=current;

cell.innerText=current;

lastPos=[r,c];

current++;

if(current>size*size){

finish(true);

}

}else{

finish(false);

}

}


function calcScore(win){

return win?1000:100;

}


async function finish(win){

active=false;

let score=calcScore(win);

await saveRank(win,score);

}


async function saveRank(win,score){

let data={

player:playerName.value||"An√≥nimo",

size:size,

score:score,

win:win,

date:Date.now()

};


// salvar local

let local=JSON.parse(
localStorage.getItem("eliteRank")||"[]"
);

local.push(data);

localStorage.setItem(
"eliteRank",
JSON.stringify(local)
);


// salvar online Firebase

if(window.salvarRankingOnline){

await salvarRankingOnline(data);

}


selectTab(size);

}


async function selectTab(tabSize){

currentTab=tabSize;

document.querySelectorAll(".tab")
.forEach(t=>t.classList.remove("active"));

document.getElementById("tab"+tabSize)
.classList.add("active");


rankingDiv.innerHTML="Carregando...";


let rank=[];

if(window.carregarRankingOnline){

rank=await carregarRankingOnline(tabSize);

}


rankingDiv.innerHTML="";


if(rank.length==0){

rankingDiv.innerHTML="Nenhum ranking ainda.";

return;

}


rank.forEach((r,i)=>{

let div=document.createElement("div");

div.className="rank-item";

div.innerHTML=

`<span>${i+1}¬∫ ${r.player}</span>
<span>${r.score}</span>`;

rankingDiv.appendChild(div);

});

}


startGame();

selectTab(5);

</script>

</body>
</html>
